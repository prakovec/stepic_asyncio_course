'''
В этом примере кода мы создадим две асинхронные корутины, одна из которых вызывает исключение, 
а другая выполняется успешно. Затем мы запустим их конкурентно и проверим исключения с использованием task.exception().
'''

import asyncio

# Определение асинхронной функции, которая имитирует ошибку
async def failing_coroutine():
    # Асинхронное ожидание на 1 секунду
    await asyncio.sleep(1)
    # Генерируем исключение ValueError
    raise ValueError("Возникла ошибка в корутине failing_coroutine()")


# Определение асинхронной функции, которая успешно завершает свою работу
async def successful_coroutine():
    # Асинхронное ожидание на 1 секунду
    await asyncio.sleep(1)
    # Вывод сообщения об успешном выполнении
    print("Успешное выполнение")

# Определение основной асинхронной функции
async def main():
    # Создание списка задач (корутин) для выполнения
    tasks = [asyncio.create_task(failing_coroutine()), asyncio.create_task(successful_coroutine())]
    # Обработка исключений, возникающих во время выполнения корутин
    try:
        # Запуск всех задач одновременно
        await asyncio.gather(*tasks)
    # Ловим исключение ValueError, если возникло
    except ValueError as _ex:
        # Выводим информацию об исключении
        print(_ex)
        
    # Перебираем все задачи и выводим результат их выполнения
    for i, task in enumerate(tasks, start=1):
        # Получаем исключение из задачи, если оно возникло
        exc = task.exception()
        # Если исключение возникло
        if exc:
            # Выводим информацию об исключении
            print(f"Задача {i}: Исключение - {exc}")
        else:
            # В противном случае сообщаем об успешном выполнении
            print(f"Задача {i}: Успешно выполнена")

# Запуск асинхронной функции main()
asyncio.run(main())